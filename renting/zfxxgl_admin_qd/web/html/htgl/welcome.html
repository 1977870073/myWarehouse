<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta name="renderer" content="webkit">
  		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<title>主页</title>
		<link rel="stylesheet" type="text/css" href="../../static/layui/css/layui.css"/>
		<link rel="stylesheet" type="text/css" href="../../static/css/admin.css"/>
		<link rel="stylesheet" type="text/css" href="../../static/fonts_expand/iconfont.css"/>
	</head>
	<body>
		<div class="wrap-container welcome-container">
			<div class="row">
				<div class="welcome-left-container col-lg-9">
					<div class="data-show">
						<ul class="clearfix">
							<li class="col-sm-6 col-md-3">
								<a href="javascript:;" class="clearfix">
									<div class="icon-bg bg-red f-l">
										<span class="iconfont">&#xe606;</span>
									</div>
									<div class="right-text-con">
										<p class="name">总用户</p>
										<p><span class="color-red" id="zyu">-</span>数据<span class="iconfont">&#xe628;</span></p>
									</div>
								</a>
							</li>
							<li class="col-sm-6 col-md-3">
								<a href="javascript:;" class="clearfix">
									<div class="icon-bg bg-org f-l">
										<span class="iconfont">&#xe60d;</span>
									</div>
									<div class="right-text-con">
										<p class="name">用户收藏<span>月</span></p>
										<p><span class="color-org" id="yhsc">-</span>数据<span class="iconfont">&#xe628;</span></p>
									</div>
								</a>
							</li>
							<li class="col-sm-6 col-md-3">
								<a href="javascript:;" class="clearfix">
									<div class="icon-bg bg-blue f-l">
										<span class="iconfont">&#xe752;</span>
									</div>
									<div class="right-text-con">
										<p class="name">后台发布数<span>月</span></p>
										<p><span class="color-blue" id="htfbs">-</span>数据<span class="iconfont">&#xe628;</span></p>
									</div>
								</a>
							</li>
							<li class="col-sm-6 col-md-3">
								<a href="javascript:;" class="clearfix">
									<div class="icon-bg bg-green f-l">
										<span class="iconfont">&#xe605;</span>
									</div>
									<div class="right-text-con">
										<p class="name">用户发布数<span>月</span></p>
										<p><span class="color-green" id="yhfbs">-</span>数据<span class="iconfont">&#xe628;</span></p>
									</div>
								</a>
							</li>
						</ul>
					</div>
					<!--图表-->
					<div class="chart-panel panel panel-default">
						<div class="panel-body" id="chart" style="height: 376px;">
						</div>
					</div>
					<!--服务器信息-->
					<div class="server-panel panel panel-default">
						<div class="panel-header">服务器信息</div>
						<div class="panel-body clearfix">
							<div class="col-md-2">
								<p class="title">服务器环境</p>
								<span class="info">Apache Tomcat7.0</span>
							</div>
							<div class="col-md-2">
								<p class="title"> Nginx版本</p>
								<span class="info">1.14.2</span>
							</div>
							<div class="col-md-2">
								<p class="title">服务器IP地址</p>
								<span class="info">127.0.0.1   </span>
							</div>
							<div class="col-md-2">
								<p class="title">服务器域名</p>
								<span class="info">localhost </span>
							</div>
							<div class="col-md-2">
								<p class="title">数据库信息</p>
								<span class="info">5.6.12-log </span>
							</div>
							<div class="col-md-2">
								<p class="title">服务器当前时间</p>
								<span class="info" id="server-info-time">2019-12-22 11:37:35</span>
							</div>
						</div>
					</div>
				</div>
				<div class="welcome-edge col-lg-3">
					<!--最新通知-->
					<div class="panel panel-default comment-panel">
						<div class="panel-header">最新通知</div>
						<div class="panel-body">
							<div class="commentbox">
								<ul class="commentList">
								  <li class="item cl"> <a href="#"><i class="avatar size-L radius"><img alt="" src="http://pic.qqtn.com/file/2013/2014-11/2014112815095076688.png"></i></a>
								    <div class="comment-main">
								      <header class="comment-header">
								        <div class="comment-meta"><a class="comment-author" href="#">秘书处</a> 发布于
								          <time title="2019年9月20日 下午2:20" datetime="2019-09-20T02:20">2019-09-20 14:20</time>
								        </div>
								      </header>
								      <div class="comment-body">
								        <p><a href="#">@所有人</a>  (っ• ̀ω•́ )っ国庆节就要放假啦，放假时间是10月1日~10月7日。（╯‵□′）╯9月29日和10月12日要上班！！！</p>
								      </div>
								    </div>
								  </li>
								   <li class="item cl"> <a href="#"><i class="avatar size-L radius"><img alt="" src="https://ss1.bdstatic.com/70cFv8Sh_Q1YnxGkpoWK1HF6hhy/it/u=2609090879,1548083328&fm=27&gp=0.jpg"></i></a>
								    <div class="comment-main">
								      <header class="comment-header">
								        <div class="comment-meta"><a class="comment-author" href="#">大老板</a> 发布于
								          <time title="2019年9月2日 下午4:40" datetime="2019-09-02T04:40">2019-09-02 16:40</time>
								        </div>
								      </header>
								      <div class="comment-body">
								        <p><a href="#">@所有人</a> 今年中秋节不发月饼了，每个员工领取100元过节补贴！！！</p>
								      </div>
								    </div>
								  </li>
								  <li class="item cl"> <a href="#"><i class="avatar size-L radius"><img alt="" src="http://pic2.zhimg.com/50/v2-1c3bd9fe6c6a28c5ca3a678549dfde28_hd.jpg"></i></a>
								    <div class="comment-main">
								     <header class="comment-header">
								        <div class="comment-meta"><a class="comment-author" href="#">秘书处</a> 发布于
								          <time title="2019年9月2日 下午4:30" datetime="2019-09-02T04:30">2019-09-02 16:30</time>
								        </div>
								      </header>
								      <div class="comment-body">
								        <p><a href="#">@所有人</a>  (っ• ̀ω•́ )っ中秋就要放假啦，放假时间是9月13日~9月15日！！！</p>
								      </div>
								    </div>
								  </li>
								  <li class="item cl"> <a href="#"><i class="avatar size-L radius"><img alt="" src="https://dev-file.iviewui.com/userinfoPDvn9gKWYihR24SpgC319vXY8qniCqj4/avatar"></i></a>
								    <div class="comment-main">
								      <header class="comment-header">
								        <div class="comment-meta"><a class="comment-author" href="#">超级管理员</a> 发布于
								          <time title="2019年8月30日 下午3:20" datetime="2019-08-30T03:20">2019-08-30 15:20</time>
								        </div>
								      </header>
								      <div class="comment-body">
								        <p><a href="#">@所有人</a> 系统处于测试阶段，若遇到问题请及时反馈！！！</p>
								      </div>
								    </div>
								  </li>
								</ul>
							</div>
							<div id="pagesbox" style="text-align: center;padding-top: 5px;">
								
							</div>
						</div>
					</div>
					
				</div>
			</div>
		</div>
		<script src="../../static/layui/layui.js" type="text/javascript" charset="utf-8"></script>
		<script src="../../static/lib/echarts/echarts.js"></script>
		<script type="text/javascript">
			layui.use(['layer','jquery'], function(){
				var layer 	= layui.layer;
				var $=layui.jquery;
				setServerTime();//设置服务器信息服务器时间
                setZYData();//获取主页头部数据
				function setZYData() {
					$.ajax({
						type: 'get',
                        async: true,
                        url: '/web/do/index/getZYData',
						success: function (data) {
						    var d = data;
							$('#zyu').text(d[0]);
							$('#yhsc').text(d[1]);
							$('#htfbs').text(d[2]);
							$('#yhfbs').text(d[3]);
                        },
						error: function (errorMsg) {
                            layer.msg("请求数据失败!")
                        }
					});
                }
				function setServerTime(){
					var t = null;
					t = setTimeout(time,1000);//开始运行
					function time()
					{
						clearTimeout(t);//清除定时器
						var dt = new Date();
						var year = dt.getFullYear(); //得到年份
						var month = dt.getMonth()+1;//得到月份
						var date = dt.getDate();//得到日期
						var h=dt.getHours();//获取时
						var m=dt.getMinutes();//获取分
						var s=dt.getSeconds();//获取秒
						document.getElementById("server-info-time").innerHTML =  year+"-"+month+"-"+date+" "+h+":"+m+":"+s;
						t = setTimeout(time,1000); //设定定时器，循环运行     
					} 
				}
				//图表
				var myChart;
				require.config({
				    paths: {
				        echarts: '../../static/lib/echarts'
				    }
				});
				require(
				    [
				        'echarts',
				        'echarts/chart/bar',
				        'echarts/chart/line',
				        'echarts/chart/map'
				    ],
				    function (ec) {
						//获过去7天日期
                        var xParam = new Array();
                        for(var i=0;i<7;i++){
                            var dt = new Date();
                            dt.setDate(dt.getDate()+(-6+i));
                            var year = dt.getFullYear(); //得到年份
                            var month = dt.getMonth()+1;//得到月份
                            var date = dt.getDate();//得到日期
                            xParam[i] = year+"/"+month+"/"+date;
                        }
                        //--- 折柱 ---
                        myChart = ec.init(document.getElementById('chart'));
                        myChart.showLoading();
                        myChart.setOption(
                            {
                                title: {
                                    text: "房源信息数据统计",
                                    textStyle: {
                                        color: "rgb(85, 85, 85)",
                                        fontSize: 18,
                                        fontStyle: "normal",
                                        fontWeight: "normal"
                                    }
                                },
                                tooltip: {
                                    trigger: "axis"
                                },
                                legend: {
                                    data: ["收藏数", "后台发布房源数", "用户发布房源数"],
                                    selectedMode: false,
                                },
                                toolbox: {
                                    show: true,
                                    feature: {
                                        dataView: {
                                            show: false,
                                            readOnly: true
                                        },
                                        magicType: {
                                            show: false,
                                            type: ["line", "bar", "stack", "tiled"]
                                        },
                                        restore: {
                                            show: false
                                        },
                                        saveAsImage: {
                                            show: true
                                        },
                                        mark: {
                                            show: false
                                        }
                                    }
                                },
                                calculable: false,
                                xAxis: [
                                    {
                                        type: "category",
                                        boundaryGap: false,
                                        data: xParam
                                    }
                                ],
                                yAxis: [
                                    {
                                        type: "value"
                                    }
                                ],
                                grid: {
                                    x2: 30,
                                    x: 50
                                }
                            }
                        );

						$.ajax({
							type: 'get',
							async: true,
							url: '/web/do/index/getEchartsData',
							success: function (data) {
								myChart.setOption(
									{
										series: [
											{
												name: "收藏数",
												type: "line",
												smooth: true,
												itemStyle: {
													normal: {
														areaStyle: {
															type: "default"
														}
													}
												},
												data: [1, 2, 3, 5, 20, 53, 42]
											},
											{
												name: "后台发布房源数",
												type: "line",
												smooth: true,
												itemStyle: {
													normal: {
														areaStyle: {
															type: "default"
														}
													}
												},
												data: [60, 66, 57, 36, 28, 41, 30]
											},
											{
												name: "用户发布房源数",
												type: "line",
												smooth: true,
												itemStyle: {
													normal: {
														areaStyle: {
															type: "default"
														},
														color: "rgb(248, 187, 116)"
													}
												},
												data: [1, 14, 40, 56, 39, 14, 2	]
											}
										]
									}
								);
								myChart.hideLoading();
							},
							error: function (errorMsg) {
								layer.msg("图表请求数据失败!")
								myChart.hideLoading();
								myChart.setOption(
									{
										series: [
											{
												name: "收藏数",
												type: "line",
												smooth: true,
												itemStyle: {
													normal: {
														areaStyle: {
															type: "default"
														}
													}
												},
												data: []
											},
											{
												name: "后台发布房源数",
												type: "line",
												smooth: true,
												itemStyle: {
													normal: {
														areaStyle: {
															type: "default"
														}
													}
												},
												data: []
											},
											{
												name: "用户发布房源数",
												type: "line",
												smooth: true,
												itemStyle: {
													normal: {
														areaStyle: {
															type: "default"
														},
														color: "rgb(248, 187, 116)"
													}
												},
												data: []
											}
										]
									}
								);
							}
						});
					}
				);
				$(window).resize(function(){
					myChart.resize();
				})
			});
		</script>
	</body>
</html>
